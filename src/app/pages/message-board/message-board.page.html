<ion-header class="ion-no-border" mode="md">
  <ion-toolbar color="light">
    <div class="toolbar-wrapper">
      <ion-title text-left>
        Family Hub
      </ion-title>
      <ion-icon name="refresh-outline" (click)="refresh()"></ion-icon>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card *ngFor="let game of baseballData">
    <ion-progress-bar *ngIf="game.gameStatus === 'In Progress'" type="indeterminate" color="warning"></ion-progress-bar>
    <ion-card-header>
      <div class="last-updated">
        <ion-chip color="warning">Sports</ion-chip>
        <ion-note color="medium">Last updated {{game.lastUpdate | date: 'MMM d' }} at {{game.lastUpdate | date: 'h:mma'}} ET</ion-note>
      </div>
      <div class="sports-banner">
        <div class="sports-teams">
          <div class="team-wrapper-away">
              <ion-avatar>
                <img *ngIf="game.awayTeam !== 'Baltimore Orioles'" alt="team-logo-away" src="../../../assets/baseball-logos/{{game.awayTeamLogoSlug}}.svg" />
                <img *ngIf="game.awayTeam === 'Baltimore Orioles'" alt="team-logo-away" src="../../../assets/baseball-logos/baltimore-orioles.svg" />
              </ion-avatar> 
              <div class="team-info-away">
                <ion-note class="record">{{game.awayTeamWins}} - {{game.awayTeamLosses}}</ion-note>
                <ion-note *ngIf="game.gameStarted === 'true'" class="score" color="dark">{{game.initialGameInfo[0].currentPlay.result.awayScore}}</ion-note>
              </div>
          </div>
          <div class="bases-outs">
            <ion-note *ngIf="game.gameStatus === 'In Progress'">{{game.currentHalfInning}}</ion-note>
            <ion-note *ngIf="game.gameStatus === 'Final'" class="final" color="dark">{{game.startTime | date: 'E M/d' }} <br> Final</ion-note>
            <ion-note *ngIf="game.gameStarted === 'false'" class="final" color="dark">{{game.startTime | date: 'E M/d' }} <br> {{game.startTime | date: 'h:mm a'}} ET</ion-note>
            <ion-avatar *ngIf="game.gameStatus === 'In Progress'">
              <img *ngIf="!game.initialGameInfo[0].currentPlay.matchup.postOnFirst && !game.initialGameInfo[0].currentPlay.matchup.postOnSecond && !game.initialGameInfo[0].currentPlay.matchup.postOnThird" src="../../../assets/baseball-data/bases-clear.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnFirst && (!game.initialGameInfo[0].currentPlay.matchup.postOnSecond && !game.initialGameInfo[0].currentPlay.matchup.postOnThird)" src="../../../assets/baseball-data/runner-on-first-only.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnSecond && (!game.initialGameInfo[0].currentPlay.matchup.postOnFirst && !game.initialGameInfo[0].currentPlay.matchup.postOnThird)" src="../../../assets/baseball-data/runner-second-only.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnThird && (!game.initialGameInfo[0].currentPlay.matchup.postOnFirst && !game.initialGameInfo[0].currentPlay.matchup.postOnSecond)" src="../../../assets/baseball-data/runner-third-only.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnFirst && game.initialGameInfo[0].currentPlay.matchup.postOnSecond && !game.initialGameInfo[0].currentPlay.matchup.postOnThird" src="../../../assets/baseball-data/runners-first-second.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnSecond && game.initialGameInfo[0].currentPlay.matchup.postOnThird && !game.initialGameInfo[0].currentPlay.matchup.postOnFirst" src="../../../assets/baseball-data/runners-second-third.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnFirst && game.initialGameInfo[0].currentPlay.matchup.postOnSecond && game.initialGameInfo[0].currentPlay.matchup.postOnThird" src="../../../assets/baseball-data/bases-loaded.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.matchup.postOnFirst && game.initialGameInfo[0].currentPlay.matchup.postOnThird && !game.initialGameInfo[0].currentPlay.matchup.postOnSecond" src="../../../assets/baseball-data/runners-corners.svg" />
            </ion-avatar>
            <ion-note *ngIf="game.gameStatus === 'In Progress'" class="current-count">{{game.initialGameInfo[0].currentPlay.count.balls}} - {{game.initialGameInfo[0].currentPlay.count.strikes}}</ion-note>
            <ion-avatar *ngIf="game.gameStatus === 'In Progress'">
              <img *ngIf="game.initialGameInfo[0].currentPlay.count.outs === 0" src="../../../assets/baseball-data/no-outs.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.count.outs === 1" src="../../../assets/baseball-data/one-out.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.count.outs === 2" src="../../../assets/baseball-data/two-outs.svg" />
              <img *ngIf="game.initialGameInfo[0].currentPlay.count.outs === 3" src="../../../assets/baseball-data/three-outs.svg" />
            </ion-avatar>
          </div>
          <div class="team-wrapper-home">
              <ion-avatar>
                <img *ngIf="game.homeTeam !== 'Baltimore Orioles'" alt="team-logo-home" src="'../../../assets/baseball-logos/{{game.homeTeamLogoSlug}}.svg" />
                <img *ngIf="game.homeTeam === 'Baltimore Orioles'" alt="team-logo-home" src="../../../assets/baseball-logos/baltimore-orioles.svg" />
              </ion-avatar> 
              <div class="team-info-home">
                <ion-note class="record">{{game.homeTeamWins}} - {{game.homeTeamLosses}}</ion-note>
                <ion-note *ngIf="game.gameStarted === 'true'" class="score" color="dark">{{game.initialGameInfo[0].currentPlay.result.homeScore}}</ion-note>
              </div>
          </div>
        </div>
      </div>
    </ion-card-header>
    <div class="pitcher-duel">
      <ion-note *ngIf="game.gameStatus !== 'In Progress' && game.gameStatus !== 'Final' && game.initialGameInfo[0].initialGameData.probablePitchers.away">SP: {{game.initialGameInfo[0].initialGameData.probablePitchers.away.fullName}}</ion-note>
      <ion-note *ngIf="game.gameStatus !== 'In Progress' && game.gameStatus !== 'Final' && !game.initialGameInfo[0].initialGameData.probablePitchers.away">SP: TBD</ion-note>
      <ion-note *ngIf="game.gameStatus !== 'In Progress' && game.gameStatus !== 'Final' && !game.initialGameInfo[0].initialGameData.probablePitchers.home">SP: TBD</ion-note>
      <ion-note *ngIf="game.gameStatus !== 'In Progress' && game.gameStatus !== 'Final' && game.initialGameInfo[0].initialGameData.probablePitchers.home">SP: {{game.initialGameInfo[0].initialGameData.probablePitchers.home.fullName}}</ion-note>
      <ion-note *ngIf="game.gameStatus === 'In Progress'">P: {{game.initialGameInfo[0].currentPlay.matchup.pitcher.fullName}}</ion-note>
      <ion-note *ngIf="game.gameStatus === 'In Progress'">AB: {{game.initialGameInfo[0].currentPlay.matchup.batter.fullName}}</ion-note>
      <ion-note *ngIf="game.gameStatus === 'Final'">W: {{game.initialGameInfo[0].finalData.winner.fullName}}</ion-note>
      <ion-note *ngIf="game.gameStatus === 'Final'">L: {{game.initialGameInfo[0].finalData.loser.fullName}}</ion-note>
    </div>
    <div class="venue" *ngIf="game.gameStatus === 'Scheduled' || game.gameStatus === 'Pre-Game'">
      <ion-note>{{game.initialGameInfo[0].initialGameData.venue.name}} <br> {{game.initialGameInfo[0].initialGameData.venue.location.city}}, {{game.initialGameInfo[0].initialGameData.venue.location.stateAbbrev}}</ion-note>
      <ion-note *ngIf="game.initialGameInfo[0].initialGameData.weather.temp && game.initialGameInfo[0].initialGameData.weather.condition">{{game.initialGameInfo[0].initialGameData.weather.temp}}&#xb0;F <br> Condition: {{game.initialGameInfo[0].initialGameData.weather.condition}}</ion-note>
    </div>
    <div *ngIf="game.gameStatus === 'In Progress'" class="game-status">
      <ion-card-subtitle>Latest:</ion-card-subtitle>
      <ion-note class="last-event">{{game.lastEvent}}</ion-note>
    </div>
    <div class="join-conversation" *ngIf="game.gameStarted === 'true'">
      <ion-note color="dark">Join the conversation <ion-icon name="chevron-forward-outline"></ion-icon></ion-note>
    </div>
  </ion-card> 

</ion-content>
